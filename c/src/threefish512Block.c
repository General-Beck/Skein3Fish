#include <threefishApi.h>
#include <stdint.h>
#include <string.h>

void threefishEncrypt512(ThreefishKey_t* keyCtx, uint64_t* input, uint64_t* output)
    {

    uint64_t b[8];
    uint64_t* k = keyCtx->key;
    uint64_t* t = keyCtx->tweak;
    memcpy(b, input, 8 * sizeof(uint64_t));

        b[1] += k[1]; b[0] += b[1] + k[0]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[3]; b[2] += b[3] + k[2]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[5] + t[0]; b[4] += b[5] + k[4]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[7]; b[6] += b[7] + k[6] + t[1]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[2]; b[0] += b[1] + k[1]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[4]; b[2] += b[3] + k[3]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[6] + t[1]; b[4] += b[5] + k[5]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[8] + 1; b[6] += b[7] + k[7] + t[2]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[3]; b[0] += b[1] + k[2]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[5]; b[2] += b[3] + k[4]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[7] + t[2]; b[4] += b[5] + k[6]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[0] + 2; b[6] += b[7] + k[8] + t[0]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[4]; b[0] += b[1] + k[3]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[6]; b[2] += b[3] + k[5]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[8] + t[0]; b[4] += b[5] + k[7]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[1] + 3; b[6] += b[7] + k[0] + t[1]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[5]; b[0] += b[1] + k[4]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[7]; b[2] += b[3] + k[6]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[0] + t[1]; b[4] += b[5] + k[8]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[2] + 4; b[6] += b[7] + k[1] + t[2]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[6]; b[0] += b[1] + k[5]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[8]; b[2] += b[3] + k[7]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[1] + t[2]; b[4] += b[5] + k[0]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[3] + 5; b[6] += b[7] + k[2] + t[0]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[7]; b[0] += b[1] + k[6]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[0]; b[2] += b[3] + k[8]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[2] + t[0]; b[4] += b[5] + k[1]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[4] + 6; b[6] += b[7] + k[3] + t[1]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[8]; b[0] += b[1] + k[7]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[1]; b[2] += b[3] + k[0]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[3] + t[1]; b[4] += b[5] + k[2]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[5] + 7; b[6] += b[7] + k[4] + t[2]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[0]; b[0] += b[1] + k[8]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[2]; b[2] += b[3] + k[1]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[4] + t[2]; b[4] += b[5] + k[3]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[6] + 8; b[6] += b[7] + k[5] + t[0]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[1]; b[0] += b[1] + k[0]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[3]; b[2] += b[3] + k[2]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[5] + t[0]; b[4] += b[5] + k[4]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[7] + 9; b[6] += b[7] + k[6] + t[1]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[2]; b[0] += b[1] + k[1]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[4]; b[2] += b[3] + k[3]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[6] + t[1]; b[4] += b[5] + k[5]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[8] + 10; b[6] += b[7] + k[7] + t[2]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[3]; b[0] += b[1] + k[2]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[5]; b[2] += b[3] + k[4]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[7] + t[2]; b[4] += b[5] + k[6]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[0] + 11; b[6] += b[7] + k[8] + t[0]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[4]; b[0] += b[1] + k[3]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[6]; b[2] += b[3] + k[5]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[8] + t[0]; b[4] += b[5] + k[7]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[1] + 12; b[6] += b[7] + k[0] + t[1]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[5]; b[0] += b[1] + k[4]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[7]; b[2] += b[3] + k[6]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[0] + t[1]; b[4] += b[5] + k[8]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[2] + 13; b[6] += b[7] + k[1] + t[2]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[6]; b[0] += b[1] + k[5]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[8]; b[2] += b[3] + k[7]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[1] + t[2]; b[4] += b[5] + k[0]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[3] + 14; b[6] += b[7] + k[2] + t[0]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[7]; b[0] += b[1] + k[6]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[0]; b[2] += b[3] + k[8]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[2] + t[0]; b[4] += b[5] + k[1]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[4] + 15; b[6] += b[7] + k[3] + t[1]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];
        b[1] += k[8]; b[0] += b[1] + k[7]; b[1] = ((b[1] << 46) | (b[1] >> (64 - 46))) ^ b[0];
        b[3] += k[1]; b[2] += b[3] + k[0]; b[3] = ((b[3] << 36) | (b[3] >> (64 - 36))) ^ b[2];
        b[5] += k[3] + t[1]; b[4] += b[5] + k[2]; b[5] = ((b[5] << 19) | (b[5] >> (64 - 19))) ^ b[4];
        b[7] += k[5] + 16; b[6] += b[7] + k[4] + t[2]; b[7] = ((b[7] << 37) | (b[7] >> (64 - 37))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 33) | (b[1] >> (64 - 33))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 27) | (b[7] >> (64 - 27))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 14) | (b[5] >> (64 - 14))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 42) | (b[3] >> (64 - 42))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 17) | (b[1] >> (64 - 17))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 49) | (b[3] >> (64 - 49))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 36) | (b[5] >> (64 - 36))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 39) | (b[7] >> (64 - 39))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 44) | (b[1] >> (64 - 44))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 9) | (b[7] >> (64 - 9))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 54) | (b[5] >> (64 - 54))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 56) | (b[3] >> (64 - 56))) ^ b[4];
        b[1] += k[0]; b[0] += b[1] + k[8]; b[1] = ((b[1] << 39) | (b[1] >> (64 - 39))) ^ b[0];
        b[3] += k[2]; b[2] += b[3] + k[1]; b[3] = ((b[3] << 30) | (b[3] >> (64 - 30))) ^ b[2];
        b[5] += k[4] + t[2]; b[4] += b[5] + k[3]; b[5] = ((b[5] << 34) | (b[5] >> (64 - 34))) ^ b[4];
        b[7] += k[6] + 17; b[6] += b[7] + k[5] + t[0]; b[7] = ((b[7] << 24) | (b[7] >> (64 - 24))) ^ b[6];
        b[2] += b[1]; b[1] = ((b[1] << 13) | (b[1] >> (64 - 13))) ^ b[2];
        b[4] += b[7]; b[7] = ((b[7] << 50) | (b[7] >> (64 - 50))) ^ b[4];
        b[6] += b[5]; b[5] = ((b[5] << 10) | (b[5] >> (64 - 10))) ^ b[6];
        b[0] += b[3]; b[3] = ((b[3] << 17) | (b[3] >> (64 - 17))) ^ b[0];
        b[4] += b[1]; b[1] = ((b[1] << 25) | (b[1] >> (64 - 25))) ^ b[4];
        b[6] += b[3]; b[3] = ((b[3] << 29) | (b[3] >> (64 - 29))) ^ b[6];
        b[0] += b[5]; b[5] = ((b[5] << 39) | (b[5] >> (64 - 39))) ^ b[0];
        b[2] += b[7]; b[7] = ((b[7] << 43) | (b[7] >> (64 - 43))) ^ b[2];
        b[6] += b[1]; b[1] = ((b[1] << 8) | (b[1] >> (64 - 8))) ^ b[6];
        b[0] += b[7]; b[7] = ((b[7] << 35) | (b[7] >> (64 - 35))) ^ b[0];
        b[2] += b[5]; b[5] = ((b[5] << 56) | (b[5] >> (64 - 56))) ^ b[2];
        b[4] += b[3]; b[3] = ((b[3] << 22) | (b[3] >> (64 - 22))) ^ b[4];


        output[0] = b[0] + k[0];
        output[1] = b[1] + k[1];
        output[2] = b[2] + k[2];
        output[3] = b[3] + k[3];
        output[4] = b[4] + k[4];
        output[5] = b[5] + k[5] + t[0];
        output[6] = b[6] + k[6] + t[1];
        output[7] = b[7] + k[7] + 18;
    }

void threefishDecrypt512(ThreefishKey_t* keyCtx, uint64_t* input, uint64_t* output)
    {

        uint64_t b[8];
 uint64_t* k = keyCtx->key;
        uint64_t* t = keyCtx->tweak;
 uint64_t tmp;

 memcpy(b, input, 8 * sizeof(uint64_t));

        b[0] -= k[0];
        b[1] -= k[1];
        b[2] -= k[2];
        b[3] -= k[3];
        b[4] -= k[4];
        b[5] -= k[5] + t[0];
        b[6] -= k[6] + t[1];
        b[7] -= k[7] + 18;
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[5] + t[0]; b[7] -= k[6] + 17;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[3]; b[5] -= k[4] + t[2];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[1]; b[3] -= k[2];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[8]; b[1] -= k[0];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[4] + t[2]; b[7] -= k[5] + 16;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[2]; b[5] -= k[3] + t[1];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[0]; b[3] -= k[1];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[7]; b[1] -= k[8];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[3] + t[1]; b[7] -= k[4] + 15;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[1]; b[5] -= k[2] + t[0];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[8]; b[3] -= k[0];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[6]; b[1] -= k[7];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[2] + t[0]; b[7] -= k[3] + 14;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[0]; b[5] -= k[1] + t[2];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[7]; b[3] -= k[8];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[5]; b[1] -= k[6];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[1] + t[2]; b[7] -= k[2] + 13;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[8]; b[5] -= k[0] + t[1];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[6]; b[3] -= k[7];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[4]; b[1] -= k[5];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[0] + t[1]; b[7] -= k[1] + 12;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[7]; b[5] -= k[8] + t[0];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[5]; b[3] -= k[6];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[3]; b[1] -= k[4];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[8] + t[0]; b[7] -= k[0] + 11;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[6]; b[5] -= k[7] + t[2];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[4]; b[3] -= k[5];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[2]; b[1] -= k[3];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[7] + t[2]; b[7] -= k[8] + 10;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[5]; b[5] -= k[6] + t[1];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[3]; b[3] -= k[4];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[1]; b[1] -= k[2];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[6] + t[1]; b[7] -= k[7] + 9;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[4]; b[5] -= k[5] + t[0];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[2]; b[3] -= k[3];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[0]; b[1] -= k[1];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[5] + t[0]; b[7] -= k[6] + 8;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[3]; b[5] -= k[4] + t[2];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[1]; b[3] -= k[2];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[8]; b[1] -= k[0];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[4] + t[2]; b[7] -= k[5] + 7;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[2]; b[5] -= k[3] + t[1];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[0]; b[3] -= k[1];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[7]; b[1] -= k[8];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[3] + t[1]; b[7] -= k[4] + 6;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[1]; b[5] -= k[2] + t[0];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[8]; b[3] -= k[0];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[6]; b[1] -= k[7];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[2] + t[0]; b[7] -= k[3] + 5;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[0]; b[5] -= k[1] + t[2];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[7]; b[3] -= k[8];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[5]; b[1] -= k[6];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[1] + t[2]; b[7] -= k[2] + 4;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[8]; b[5] -= k[0] + t[1];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[6]; b[3] -= k[7];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[4]; b[1] -= k[5];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[0] + t[1]; b[7] -= k[1] + 3;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[7]; b[5] -= k[8] + t[0];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[5]; b[3] -= k[6];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[3]; b[1] -= k[4];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[8] + t[0]; b[7] -= k[0] + 2;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[6]; b[5] -= k[7] + t[2];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[4]; b[3] -= k[5];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[2]; b[1] -= k[3];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 22) | (tmp << (64 - 22)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 56) | (tmp << (64 - 56)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 35) | (tmp << (64 - 35)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 8) | (tmp << (64 - 8)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 43) | (tmp << (64 - 43)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 29) | (tmp << (64 - 29)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 25) | (tmp << (64 - 25)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 17) | (tmp << (64 - 17)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 10) | (tmp << (64 - 10)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 50) | (tmp << (64 - 50)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 13) | (tmp << (64 - 13)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 24) | (tmp << (64 - 24)); b[6] -= b[7] + k[7] + t[2]; b[7] -= k[8] + 1;
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 34) | (tmp << (64 - 34)); b[4] -= b[5] + k[5]; b[5] -= k[6] + t[1];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 30) | (tmp << (64 - 30)); b[2] -= b[3] + k[3]; b[3] -= k[4];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 39) | (tmp << (64 - 39)); b[0] -= b[1] + k[1]; b[1] -= k[2];
        tmp = b[3] ^ b[4]; b[3] = (tmp >> 56) | (tmp << (64 - 56)); b[4] -= b[3];
        tmp = b[5] ^ b[2]; b[5] = (tmp >> 54) | (tmp << (64 - 54)); b[2] -= b[5];
        tmp = b[7] ^ b[0]; b[7] = (tmp >> 9) | (tmp << (64 - 9)); b[0] -= b[7];
        tmp = b[1] ^ b[6]; b[1] = (tmp >> 44) | (tmp << (64 - 44)); b[6] -= b[1];
        tmp = b[7] ^ b[2]; b[7] = (tmp >> 39) | (tmp << (64 - 39)); b[2] -= b[7];
        tmp = b[5] ^ b[0]; b[5] = (tmp >> 36) | (tmp << (64 - 36)); b[0] -= b[5];
        tmp = b[3] ^ b[6]; b[3] = (tmp >> 49) | (tmp << (64 - 49)); b[6] -= b[3];
        tmp = b[1] ^ b[4]; b[1] = (tmp >> 17) | (tmp << (64 - 17)); b[4] -= b[1];
        tmp = b[3] ^ b[0]; b[3] = (tmp >> 42) | (tmp << (64 - 42)); b[0] -= b[3];
        tmp = b[5] ^ b[6]; b[5] = (tmp >> 14) | (tmp << (64 - 14)); b[6] -= b[5];
        tmp = b[7] ^ b[4]; b[7] = (tmp >> 27) | (tmp << (64 - 27)); b[4] -= b[7];
        tmp = b[1] ^ b[2]; b[1] = (tmp >> 33) | (tmp << (64 - 33)); b[2] -= b[1];
        tmp = b[7] ^ b[6]; b[7] = (tmp >> 37) | (tmp << (64 - 37)); b[6] -= b[7] + k[6] + t[1]; b[7] -= k[7];
        tmp = b[5] ^ b[4]; b[5] = (tmp >> 19) | (tmp << (64 - 19)); b[4] -= b[5] + k[4]; b[5] -= k[5] + t[0];
        tmp = b[3] ^ b[2]; b[3] = (tmp >> 36) | (tmp << (64 - 36)); b[2] -= b[3] + k[2]; b[3] -= k[3];
        tmp = b[1] ^ b[0]; b[1] = (tmp >> 46) | (tmp << (64 - 46)); b[0] -= b[1] + k[0]; b[1] -= k[1];

        output[7] = b[7];
        output[6] = b[6];
        output[5] = b[5];
        output[4] = b[4];
        output[3] = b[3];
        output[2] = b[2];
        output[1] = b[1];
        output[0] = b[0];
    }
